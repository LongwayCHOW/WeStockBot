我结合你的进行优化：
1、赚钱真假，应该用自由现金流 /营收，允许拿钱去扩产，但别过分了，可以排除那些需要持续靠加大投入来维持竞争优势的公司
2、护城河因子改为(毛利率 x 周转率)，这样就包含高周转和高毛利的
3、赚钱效率，求连续 5 年的 ROE中位数即可，值越大，公司越好
4、安全性，对于普通公司不要和赛道股拉太大差距（(账上现金 / 营收) +(50% - 有息负债率)），对于银行就直接用 ROA
5、价格，直接就用 净利润增长率 -PE‘/ k，市场占有率第一 k=150， 第二以下均为 k=100，这样就不会错杀一级蓝筹，而且 PE 要根据行业进行修正 PE’ = (市值 - 账上净现金) / 净利润 / 行业系数 J，银行 J=0.5，水电/核电（公用事业）J=1.3，消费/医药 J=1.5，科技/互联网 J = 1.2，假如市占率第一的消费公司 a 利润增长率是 15%但 18 倍 PE ，则价格因子就是 15% - （18/150）/1.5）=0.07，说明公司还不错，并不是负数；“(市值 - 净现金) / 净利润 来代替 PE” 会剔除长江电力
6、投入资本回报率ROIC，（息税前利润 (EBIT)×(1−税率) ）/ （有息负债 +股东权益）
因此，我们的选股公式就是当“安全性、价格”2 个因子均为正时，挑选最高的 Z 值的公司，即   Z =（自由现金流 /净利润* (1 - 资本开支/营收)）* (毛利率 x 周转率) _ 5 年的 ROE中位数 （(账上现金 / 营收) +(50% - 有息负债率)） （净利润增长率 -(市值 - 账上净现金) / 净利润 / 行业系数 J / k）_ （税前利润 (EBIT)×(1−税率) ）/ （有息负债 +股东权益）

强调，一定是从“安全性、价格”2 个因子均为正时，才挑选 Z 值，不然会出现负负得正，没有意义
